#include "TH1.h"
#include "TTree.h"
#include "TKey.h"
#include "Riostream.h"
#include <TCanvas.h>
#include <TLatex.h>
#include "TGraphErrors.h"
#include "TLegend.h"
#include <TPad.h>
#include <sstream>
#include "TVectorD.h"
#include "TChain.h"
#include "TGraph.h"
#include "TFile.h"

using std::string;
using std::cout;
using std::endl;
using std::istringstream;

double LUMI = 35.9;
double BR = (0.33*0.33*0.67*3 + 0.33*0.33*0.33);

int makeLimitTemplates_aQGC_3l(std::string infile, std::string outfile)
{
  std::string inputfilename=(infile+".root").c_str();
  TChain *tree=new TChain("ST_Tree");
  tree->Add(inputfilename.c_str());
  std::cout<<"Opened input file "<<inputfilename<<std::endl;

  Double_t        ST_rwgt67_0SFOS;
  Double_t        ST_rwgt68_0SFOS;
  Double_t        ST_rwgt69_0SFOS;
  Double_t        ST_rwgt70_0SFOS;
  Double_t        ST_rwgt71_0SFOS;
  Double_t        ST_rwgt72_0SFOS;
  Double_t        ST_rwgt73_0SFOS;
  Double_t        ST_rwgt74_0SFOS;
  Double_t        ST_rwgt75_0SFOS;
  Double_t        ST_rwgt76_0SFOS;
  Double_t        ST_rwgt77_0SFOS;
  Double_t        ST_bkg_0SFOS;
  Double_t        ST_rwgt67_1SFOS;
  Double_t        ST_rwgt68_1SFOS;
  Double_t        ST_rwgt69_1SFOS;
  Double_t        ST_rwgt70_1SFOS;
  Double_t        ST_rwgt71_1SFOS;
  Double_t        ST_rwgt72_1SFOS;
  Double_t        ST_rwgt73_1SFOS;
  Double_t        ST_rwgt74_1SFOS;
  Double_t        ST_rwgt75_1SFOS;
  Double_t        ST_rwgt76_1SFOS;
  Double_t        ST_rwgt77_1SFOS;
  Double_t        ST_bkg_1SFOS;
  Double_t        ST_rwgt67_2SFOS;
  Double_t        ST_rwgt68_2SFOS;
  Double_t        ST_rwgt69_2SFOS;
  Double_t        ST_rwgt70_2SFOS;
  Double_t        ST_rwgt71_2SFOS;
  Double_t        ST_rwgt72_2SFOS;
  Double_t        ST_rwgt73_2SFOS;
  Double_t        ST_rwgt74_2SFOS;
  Double_t        ST_rwgt75_2SFOS;
  Double_t        ST_rwgt76_2SFOS;
  Double_t        ST_rwgt77_2SFOS;
  Double_t        ST_bkg_2SFOS;
  Double_t        weight_rwgt67_0SFOS;
  Double_t        weight_rwgt68_0SFOS;
  Double_t        weight_rwgt69_0SFOS;
  Double_t        weight_rwgt70_0SFOS;
  Double_t        weight_rwgt71_0SFOS;
  Double_t        weight_rwgt72_0SFOS;
  Double_t        weight_rwgt73_0SFOS;
  Double_t        weight_rwgt74_0SFOS;
  Double_t        weight_rwgt75_0SFOS;
  Double_t        weight_rwgt76_0SFOS;
  Double_t        weight_rwgt77_0SFOS;
  Double_t        weight_bkg_0SFOS;
  Double_t        weight_rwgt67_1SFOS;
  Double_t        weight_rwgt68_1SFOS;
  Double_t        weight_rwgt69_1SFOS;
  Double_t        weight_rwgt70_1SFOS;
  Double_t        weight_rwgt71_1SFOS;
  Double_t        weight_rwgt72_1SFOS;
  Double_t        weight_rwgt73_1SFOS;
  Double_t        weight_rwgt74_1SFOS;
  Double_t        weight_rwgt75_1SFOS;
  Double_t        weight_rwgt76_1SFOS;
  Double_t        weight_rwgt77_1SFOS;
  Double_t        weight_bkg_1SFOS;
  Double_t        weight_rwgt67_2SFOS;
  Double_t        weight_rwgt68_2SFOS;
  Double_t        weight_rwgt69_2SFOS;
  Double_t        weight_rwgt70_2SFOS;
  Double_t        weight_rwgt71_2SFOS;
  Double_t        weight_rwgt72_2SFOS;
  Double_t        weight_rwgt73_2SFOS;
  Double_t        weight_rwgt74_2SFOS;
  Double_t        weight_rwgt75_2SFOS;
  Double_t        weight_rwgt76_2SFOS;
  Double_t        weight_rwgt77_2SFOS;
  Double_t        weight_bkg_2SFOS;

  tree->SetBranchAddress("ST_rwgt67_0SFOS", &(ST_rwgt67_0SFOS));
  tree->SetBranchAddress("ST_rwgt68_0SFOS", &(ST_rwgt68_0SFOS));  
  tree->SetBranchAddress("ST_rwgt69_0SFOS", &(ST_rwgt69_0SFOS));
  tree->SetBranchAddress("ST_rwgt70_0SFOS", &(ST_rwgt70_0SFOS));
  tree->SetBranchAddress("ST_rwgt71_0SFOS", &(ST_rwgt71_0SFOS));
  tree->SetBranchAddress("ST_rwgt72_0SFOS", &(ST_rwgt72_0SFOS));
  tree->SetBranchAddress("ST_rwgt73_0SFOS", &(ST_rwgt73_0SFOS));
  tree->SetBranchAddress("ST_rwgt74_0SFOS", &(ST_rwgt74_0SFOS));
  tree->SetBranchAddress("ST_rwgt75_0SFOS", &(ST_rwgt75_0SFOS));
  tree->SetBranchAddress("ST_rwgt76_0SFOS", &(ST_rwgt76_0SFOS));
  tree->SetBranchAddress("ST_rwgt77_0SFOS", &(ST_rwgt77_0SFOS));
  tree->SetBranchAddress("ST_bkg_0SFOS", &(ST_bkg_0SFOS));
  tree->SetBranchAddress("ST_rwgt67_1SFOS", &(ST_rwgt67_1SFOS));
  tree->SetBranchAddress("ST_rwgt68_1SFOS", &(ST_rwgt68_1SFOS));
  tree->SetBranchAddress("ST_rwgt69_1SFOS", &(ST_rwgt69_1SFOS));
  tree->SetBranchAddress("ST_rwgt70_1SFOS", &(ST_rwgt70_1SFOS));
  tree->SetBranchAddress("ST_rwgt71_1SFOS", &(ST_rwgt71_1SFOS));
  tree->SetBranchAddress("ST_rwgt72_1SFOS", &(ST_rwgt72_1SFOS));
  tree->SetBranchAddress("ST_rwgt73_1SFOS", &(ST_rwgt73_1SFOS));
  tree->SetBranchAddress("ST_rwgt74_1SFOS", &(ST_rwgt74_1SFOS));
  tree->SetBranchAddress("ST_rwgt75_1SFOS", &(ST_rwgt75_1SFOS));
  tree->SetBranchAddress("ST_rwgt76_1SFOS", &(ST_rwgt76_1SFOS));
  tree->SetBranchAddress("ST_rwgt77_1SFOS", &(ST_rwgt77_1SFOS));
  tree->SetBranchAddress("ST_bkg_1SFOS", &(ST_bkg_1SFOS));
  tree->SetBranchAddress("ST_rwgt67_2SFOS", &(ST_rwgt67_2SFOS));
  tree->SetBranchAddress("ST_rwgt68_2SFOS", &(ST_rwgt68_2SFOS));
  tree->SetBranchAddress("ST_rwgt69_2SFOS", &(ST_rwgt69_2SFOS));
  tree->SetBranchAddress("ST_rwgt70_2SFOS", &(ST_rwgt70_2SFOS));
  tree->SetBranchAddress("ST_rwgt71_2SFOS", &(ST_rwgt71_2SFOS));
  tree->SetBranchAddress("ST_rwgt72_2SFOS", &(ST_rwgt72_2SFOS));
  tree->SetBranchAddress("ST_rwgt73_2SFOS", &(ST_rwgt73_2SFOS));
  tree->SetBranchAddress("ST_rwgt74_2SFOS", &(ST_rwgt74_2SFOS));
  tree->SetBranchAddress("ST_rwgt75_2SFOS", &(ST_rwgt75_2SFOS));
  tree->SetBranchAddress("ST_rwgt76_2SFOS", &(ST_rwgt76_2SFOS));
  tree->SetBranchAddress("ST_rwgt77_2SFOS", &(ST_rwgt77_2SFOS));
  tree->SetBranchAddress("ST_bkg_2SFOS", &(ST_bkg_2SFOS));
  tree->SetBranchAddress("weight_rwgt67_0SFOS", &(weight_rwgt67_0SFOS));
  tree->SetBranchAddress("weight_rwgt68_0SFOS", &(weight_rwgt68_0SFOS));
  tree->SetBranchAddress("weight_rwgt69_0SFOS", &(weight_rwgt69_0SFOS));
  tree->SetBranchAddress("weight_rwgt70_0SFOS", &(weight_rwgt70_0SFOS));
  tree->SetBranchAddress("weight_rwgt71_0SFOS", &(weight_rwgt71_0SFOS));
  tree->SetBranchAddress("weight_rwgt72_0SFOS", &(weight_rwgt72_0SFOS));
  tree->SetBranchAddress("weight_rwgt73_0SFOS", &(weight_rwgt73_0SFOS));
  tree->SetBranchAddress("weight_rwgt74_0SFOS", &(weight_rwgt74_0SFOS));
  tree->SetBranchAddress("weight_rwgt75_0SFOS", &(weight_rwgt75_0SFOS));
  tree->SetBranchAddress("weight_rwgt76_0SFOS", &(weight_rwgt76_0SFOS));
  tree->SetBranchAddress("weight_rwgt77_0SFOS", &(weight_rwgt77_0SFOS));
  tree->SetBranchAddress("weight_bkg_0SFOS", &(weight_bkg_0SFOS));
  tree->SetBranchAddress("weight_rwgt67_1SFOS", &(weight_rwgt67_1SFOS));
  tree->SetBranchAddress("weight_rwgt68_1SFOS", &(weight_rwgt68_1SFOS));
  tree->SetBranchAddress("weight_rwgt69_1SFOS", &(weight_rwgt69_1SFOS));
  tree->SetBranchAddress("weight_rwgt70_1SFOS", &(weight_rwgt70_1SFOS));
  tree->SetBranchAddress("weight_rwgt71_1SFOS", &(weight_rwgt71_1SFOS));
  tree->SetBranchAddress("weight_rwgt72_1SFOS", &(weight_rwgt72_1SFOS));
  tree->SetBranchAddress("weight_rwgt73_1SFOS", &(weight_rwgt73_1SFOS));
  tree->SetBranchAddress("weight_rwgt74_1SFOS", &(weight_rwgt74_1SFOS));
  tree->SetBranchAddress("weight_rwgt75_1SFOS", &(weight_rwgt75_1SFOS));
  tree->SetBranchAddress("weight_rwgt76_1SFOS", &(weight_rwgt76_1SFOS));
  tree->SetBranchAddress("weight_rwgt77_1SFOS", &(weight_rwgt77_1SFOS));
  tree->SetBranchAddress("weight_bkg_1SFOS", &(weight_bkg_1SFOS));
  tree->SetBranchAddress("weight_rwgt67_2SFOS", &(weight_rwgt67_2SFOS));
  tree->SetBranchAddress("weight_rwgt68_2SFOS", &(weight_rwgt68_2SFOS));
  tree->SetBranchAddress("weight_rwgt69_2SFOS", &(weight_rwgt69_2SFOS));
  tree->SetBranchAddress("weight_rwgt70_2SFOS", &(weight_rwgt70_2SFOS));
  tree->SetBranchAddress("weight_rwgt71_2SFOS", &(weight_rwgt71_2SFOS));
  tree->SetBranchAddress("weight_rwgt72_2SFOS", &(weight_rwgt72_2SFOS));
  tree->SetBranchAddress("weight_rwgt73_2SFOS", &(weight_rwgt73_2SFOS));
  tree->SetBranchAddress("weight_rwgt74_2SFOS", &(weight_rwgt74_2SFOS));
  tree->SetBranchAddress("weight_rwgt75_2SFOS", &(weight_rwgt75_2SFOS));
  tree->SetBranchAddress("weight_rwgt76_2SFOS", &(weight_rwgt76_2SFOS));
  tree->SetBranchAddress("weight_rwgt77_2SFOS", &(weight_rwgt77_2SFOS));
  tree->SetBranchAddress("weight_bkg_2SFOS", &(weight_bkg_2SFOS));

  Float_t rebin_array[] = {0, 250.0, 500.0, 750.0, 1000.0, 1250.0, 1500.0, 1750.0, 2000.0, 2500.0, 3000.0, 4000.0, 5000.0, 10000.0};
  Int_t  bin = sizeof(rebin_array)/sizeof(Float_t) - 1;
  TH1F *h_ST_rebin = new TH1F("h_ST_rebin", "h_ST_rebin", bin, rebin_array);  
  TH1F *h_ST_rebin_2 = new TH1F("h_ST_rebin_2", "h_ST_rebin_2", bin, rebin_array);

  TH1F *h_ST_rgwt67_0SFOS = new TH1F("h_ST_rgwt67_0SFOS", "h_ST_rgwt67_0SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt67_0SFOS->Sumw2();
  TH1F *h_ST_rgwt68_0SFOS = new TH1F("h_ST_rgwt68_0SFOS", "h_ST_rgwt68_0SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt68_0SFOS->Sumw2();
  TH1F *h_ST_rgwt69_0SFOS = new TH1F("h_ST_rgwt69_0SFOS", "h_ST_rgwt69_0SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt69_0SFOS->Sumw2();
  TH1F *h_ST_rgwt70_0SFOS = new TH1F("h_ST_rgwt70_0SFOS", "h_ST_rgwt70_0SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt70_0SFOS->Sumw2();
  TH1F *h_ST_rgwt71_0SFOS = new TH1F("h_ST_rgwt71_0SFOS", "h_ST_rgwt71_0SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt71_0SFOS->Sumw2();
  TH1F *h_ST_rgwt72_0SFOS = new TH1F("h_ST_rgwt72_0SFOS", "h_ST_rgwt72_0SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt72_0SFOS->Sumw2();
  TH1F *h_ST_rgwt73_0SFOS = new TH1F("h_ST_rgwt73_0SFOS", "h_ST_rgwt73_0SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt73_0SFOS->Sumw2();
  TH1F *h_ST_rgwt74_0SFOS = new TH1F("h_ST_rgwt74_0SFOS", "h_ST_rgwt74_0SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt74_0SFOS->Sumw2();
  TH1F *h_ST_rgwt75_0SFOS = new TH1F("h_ST_rgwt75_0SFOS", "h_ST_rgwt75_0SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt75_0SFOS->Sumw2();
  TH1F *h_ST_rgwt76_0SFOS = new TH1F("h_ST_rgwt76_0SFOS", "h_ST_rgwt76_0SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt76_0SFOS->Sumw2();
  TH1F *h_ST_rgwt77_0SFOS = new TH1F("h_ST_rgwt77_0SFOS", "h_ST_rgwt77_0SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt77_0SFOS->Sumw2();  
  TH1F *h_ST_bkg_0SFOS = new TH1F("h_ST_bkg_0SFOS", "h_ST_bkg_0SFOS", 20.0, 0.0, 10000.0); h_ST_bkg_0SFOS->Sumw2();
  TH1F *h_ST_rgwt67_1SFOS = new TH1F("h_ST_rgwt67_1SFOS", "h_ST_rgwt67_1SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt67_1SFOS->Sumw2();
  TH1F *h_ST_rgwt68_1SFOS = new TH1F("h_ST_rgwt68_1SFOS", "h_ST_rgwt68_1SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt68_1SFOS->Sumw2();
  TH1F *h_ST_rgwt69_1SFOS = new TH1F("h_ST_rgwt69_1SFOS", "h_ST_rgwt69_1SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt69_1SFOS->Sumw2();
  TH1F *h_ST_rgwt70_1SFOS = new TH1F("h_ST_rgwt70_1SFOS", "h_ST_rgwt70_1SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt70_1SFOS->Sumw2();
  TH1F *h_ST_rgwt71_1SFOS = new TH1F("h_ST_rgwt71_1SFOS", "h_ST_rgwt71_1SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt71_1SFOS->Sumw2();
  TH1F *h_ST_rgwt72_1SFOS = new TH1F("h_ST_rgwt72_1SFOS", "h_ST_rgwt72_1SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt72_1SFOS->Sumw2();
  TH1F *h_ST_rgwt73_1SFOS = new TH1F("h_ST_rgwt73_1SFOS", "h_ST_rgwt73_1SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt73_1SFOS->Sumw2();
  TH1F *h_ST_rgwt74_1SFOS = new TH1F("h_ST_rgwt74_1SFOS", "h_ST_rgwt74_1SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt74_1SFOS->Sumw2();
  TH1F *h_ST_rgwt75_1SFOS = new TH1F("h_ST_rgwt75_1SFOS", "h_ST_rgwt75_1SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt75_1SFOS->Sumw2();
  TH1F *h_ST_rgwt76_1SFOS = new TH1F("h_ST_rgwt76_1SFOS", "h_ST_rgwt76_1SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt76_1SFOS->Sumw2();
  TH1F *h_ST_rgwt77_1SFOS = new TH1F("h_ST_rgwt77_1SFOS", "h_ST_rgwt77_1SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt77_1SFOS->Sumw2();
  TH1F *h_ST_bkg_1SFOS = new TH1F("h_ST_bkg_1SFOS", "h_ST_bkg_1SFOS", 20.0, 0.0, 10000.0); h_ST_bkg_1SFOS->Sumw2(); 
  TH1F *h_ST_rgwt67_2SFOS = new TH1F("h_ST_rgwt67_2SFOS", "h_ST_rgwt67_2SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt67_2SFOS->Sumw2();
  TH1F *h_ST_rgwt68_2SFOS = new TH1F("h_ST_rgwt68_2SFOS", "h_ST_rgwt68_2SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt68_2SFOS->Sumw2();
  TH1F *h_ST_rgwt69_2SFOS = new TH1F("h_ST_rgwt69_2SFOS", "h_ST_rgwt69_2SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt69_2SFOS->Sumw2();
  TH1F *h_ST_rgwt70_2SFOS = new TH1F("h_ST_rgwt70_2SFOS", "h_ST_rgwt70_2SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt70_2SFOS->Sumw2();
  TH1F *h_ST_rgwt71_2SFOS = new TH1F("h_ST_rgwt71_2SFOS", "h_ST_rgwt71_2SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt71_2SFOS->Sumw2();
  TH1F *h_ST_rgwt72_2SFOS = new TH1F("h_ST_rgwt72_2SFOS", "h_ST_rgwt72_2SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt72_2SFOS->Sumw2();
  TH1F *h_ST_rgwt73_2SFOS = new TH1F("h_ST_rgwt73_2SFOS", "h_ST_rgwt73_2SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt73_2SFOS->Sumw2();
  TH1F *h_ST_rgwt74_2SFOS = new TH1F("h_ST_rgwt74_2SFOS", "h_ST_rgwt74_2SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt74_2SFOS->Sumw2();
  TH1F *h_ST_rgwt75_2SFOS = new TH1F("h_ST_rgwt75_2SFOS", "h_ST_rgwt75_2SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt75_2SFOS->Sumw2();
  TH1F *h_ST_rgwt76_2SFOS = new TH1F("h_ST_rgwt76_2SFOS", "h_ST_rgwt76_2SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt76_2SFOS->Sumw2();
  TH1F *h_ST_rgwt77_2SFOS = new TH1F("h_ST_rgwt77_2SFOS", "h_ST_rgwt77_2SFOS", 20.0, 0.0, 10000.0); h_ST_rgwt77_2SFOS->Sumw2();
  TH1F *h_ST_bkg_2SFOS = new TH1F("h_ST_bkg_2SFOS", "h_ST_bkg_2SFOS", 20.0, 0.0, 10000.0); h_ST_bkg_2SFOS->Sumw2();
  TH1F *h_ST_rgwt67_0SFOS_MinusSM = new TH1F("h_ST_rgwt67_0SFOS_MinusSM", "h_ST_rgwt67_0SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt67_0SFOS_MinusSM->Sumw2(); 
  TH1F *h_ST_rgwt68_0SFOS_MinusSM = new TH1F("h_ST_rgwt68_0SFOS_MinusSM", "h_ST_rgwt68_0SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt68_0SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt69_0SFOS_MinusSM = new TH1F("h_ST_rgwt69_0SFOS_MinusSM", "h_ST_rgwt69_0SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt69_0SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt70_0SFOS_MinusSM = new TH1F("h_ST_rgwt70_0SFOS_MinusSM", "h_ST_rgwt70_0SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt70_0SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt71_0SFOS_MinusSM = new TH1F("h_ST_rgwt71_0SFOS_MinusSM", "h_ST_rgwt71_0SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt71_0SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt72_0SFOS_MinusSM = new TH1F("h_ST_rgwt72_0SFOS_MinusSM", "h_ST_rgwt72_0SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt72_0SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt73_0SFOS_MinusSM = new TH1F("h_ST_rgwt73_0SFOS_MinusSM", "h_ST_rgwt73_0SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt73_0SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt74_0SFOS_MinusSM = new TH1F("h_ST_rgwt74_0SFOS_MinusSM", "h_ST_rgwt74_0SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt74_0SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt75_0SFOS_MinusSM = new TH1F("h_ST_rgwt75_0SFOS_MinusSM", "h_ST_rgwt75_0SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt75_0SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt76_0SFOS_MinusSM = new TH1F("h_ST_rgwt76_0SFOS_MinusSM", "h_ST_rgwt76_0SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt76_0SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt77_0SFOS_MinusSM = new TH1F("h_ST_rgwt77_0SFOS_MinusSM", "h_ST_rgwt77_0SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt77_0SFOS_MinusSM->Sumw2();
  TH1F *h_ST_bkg_0SFOS_PlusSM = new TH1F("h_ST_bkg_0SFOS_PlusSM", "h_ST_bkg_0SFOS_PlusSM", 20.0, 0.0, 10000.0); h_ST_bkg_0SFOS_PlusSM->Sumw2();
  TH1F *h_ST_rgwt67_1SFOS_MinusSM = new TH1F("h_ST_rgwt67_1SFOS_MinusSM", "h_ST_rgwt67_1SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt67_1SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt68_1SFOS_MinusSM = new TH1F("h_ST_rgwt68_1SFOS_MinusSM", "h_ST_rgwt68_1SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt68_1SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt69_1SFOS_MinusSM = new TH1F("h_ST_rgwt69_1SFOS_MinusSM", "h_ST_rgwt69_1SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt69_1SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt70_1SFOS_MinusSM = new TH1F("h_ST_rgwt70_1SFOS_MinusSM", "h_ST_rgwt70_1SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt70_1SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt71_1SFOS_MinusSM = new TH1F("h_ST_rgwt71_1SFOS_MinusSM", "h_ST_rgwt71_1SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt71_1SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt72_1SFOS_MinusSM = new TH1F("h_ST_rgwt72_1SFOS_MinusSM", "h_ST_rgwt72_1SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt72_1SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt73_1SFOS_MinusSM = new TH1F("h_ST_rgwt73_1SFOS_MinusSM", "h_ST_rgwt73_1SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt73_1SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt74_1SFOS_MinusSM = new TH1F("h_ST_rgwt74_1SFOS_MinusSM", "h_ST_rgwt74_1SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt74_1SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt75_1SFOS_MinusSM = new TH1F("h_ST_rgwt75_1SFOS_MinusSM", "h_ST_rgwt75_1SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt75_1SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt76_1SFOS_MinusSM = new TH1F("h_ST_rgwt76_1SFOS_MinusSM", "h_ST_rgwt76_1SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt76_1SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt77_1SFOS_MinusSM = new TH1F("h_ST_rgwt77_1SFOS_MinusSM", "h_ST_rgwt77_1SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt77_1SFOS_MinusSM->Sumw2();
  TH1F *h_ST_bkg_1SFOS_PlusSM = new TH1F("h_ST_bkg_1SFOS_PlusSM", "h_ST_bkg_1SFOS_PlusSM", 20.0, 0.0, 10000.0); h_ST_bkg_1SFOS_PlusSM->Sumw2();
  TH1F *h_ST_rgwt67_2SFOS_MinusSM = new TH1F("h_ST_rgwt67_2SFOS_MinusSM", "h_ST_rgwt67_2SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt67_2SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt68_2SFOS_MinusSM = new TH1F("h_ST_rgwt68_2SFOS_MinusSM", "h_ST_rgwt68_2SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt68_2SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt69_2SFOS_MinusSM = new TH1F("h_ST_rgwt69_2SFOS_MinusSM", "h_ST_rgwt69_2SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt69_2SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt70_2SFOS_MinusSM = new TH1F("h_ST_rgwt70_2SFOS_MinusSM", "h_ST_rgwt70_2SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt70_2SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt71_2SFOS_MinusSM = new TH1F("h_ST_rgwt71_2SFOS_MinusSM", "h_ST_rgwt71_2SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt71_2SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt72_2SFOS_MinusSM = new TH1F("h_ST_rgwt72_2SFOS_MinusSM", "h_ST_rgwt72_2SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt72_2SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt73_2SFOS_MinusSM = new TH1F("h_ST_rgwt73_2SFOS_MinusSM", "h_ST_rgwt73_2SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt73_2SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt74_2SFOS_MinusSM = new TH1F("h_ST_rgwt74_2SFOS_MinusSM", "h_ST_rgwt74_2SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt74_2SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt75_2SFOS_MinusSM = new TH1F("h_ST_rgwt75_2SFOS_MinusSM", "h_ST_rgwt75_2SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt75_2SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt76_2SFOS_MinusSM = new TH1F("h_ST_rgwt76_2SFOS_MinusSM", "h_ST_rgwt76_2SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt76_2SFOS_MinusSM->Sumw2();
  TH1F *h_ST_rgwt77_2SFOS_MinusSM = new TH1F("h_ST_rgwt77_2SFOS_MinusSM", "h_ST_rgwt77_2SFOS_MinusSM", 20.0, 0.0, 10000.0); h_ST_rgwt77_2SFOS_MinusSM->Sumw2();
  TH1F *h_ST_bkg_2SFOS_PlusSM = new TH1F("h_ST_bkg_2SFOS_PlusSM", "h_ST_bkg_2SFOS_PlusSM", 20.0, 0.0, 10000.0); h_ST_bkg_2SFOS_PlusSM->Sumw2();

  int nEvents=tree->GetEntries();
  std::cout << "nEvents= " << nEvents << std::endl;

  for (int i=0; i<nEvents; ++i)
  {
    tree->GetEvent(i);
    h_ST_rgwt67_0SFOS->Fill(ST_rwgt67_0SFOS, weight_rwgt67_0SFOS*LUMI*BR);
    h_ST_rgwt68_0SFOS->Fill(ST_rwgt68_0SFOS, weight_rwgt68_0SFOS*LUMI*BR);
    h_ST_rgwt69_0SFOS->Fill(ST_rwgt69_0SFOS, weight_rwgt69_0SFOS*LUMI*BR);
    h_ST_rgwt70_0SFOS->Fill(ST_rwgt70_0SFOS, weight_rwgt70_0SFOS*LUMI*BR);
    h_ST_rgwt71_0SFOS->Fill(ST_rwgt71_0SFOS, weight_rwgt71_0SFOS*LUMI*BR);
    h_ST_rgwt72_0SFOS->Fill(ST_rwgt72_0SFOS, weight_rwgt72_0SFOS*LUMI*BR);
    h_ST_rgwt73_0SFOS->Fill(ST_rwgt73_0SFOS, weight_rwgt73_0SFOS*LUMI*BR);
    h_ST_rgwt74_0SFOS->Fill(ST_rwgt74_0SFOS, weight_rwgt74_0SFOS*LUMI*BR);
    h_ST_rgwt75_0SFOS->Fill(ST_rwgt75_0SFOS, weight_rwgt75_0SFOS*LUMI*BR);
    h_ST_rgwt76_0SFOS->Fill(ST_rwgt76_0SFOS, weight_rwgt76_0SFOS*LUMI*BR);
    h_ST_rgwt77_0SFOS->Fill(ST_rwgt77_0SFOS, weight_rwgt77_0SFOS*LUMI*BR);
    h_ST_bkg_0SFOS->Fill(ST_bkg_0SFOS, weight_bkg_0SFOS*LUMI);

    h_ST_rgwt67_1SFOS->Fill(ST_rwgt67_1SFOS, weight_rwgt67_1SFOS*LUMI*BR);
    h_ST_rgwt68_1SFOS->Fill(ST_rwgt68_1SFOS, weight_rwgt68_1SFOS*LUMI*BR);
    h_ST_rgwt69_1SFOS->Fill(ST_rwgt69_1SFOS, weight_rwgt69_1SFOS*LUMI*BR);
    h_ST_rgwt70_1SFOS->Fill(ST_rwgt70_1SFOS, weight_rwgt70_1SFOS*LUMI*BR);
    h_ST_rgwt71_1SFOS->Fill(ST_rwgt71_1SFOS, weight_rwgt71_1SFOS*LUMI*BR);
    h_ST_rgwt72_1SFOS->Fill(ST_rwgt72_1SFOS, weight_rwgt72_1SFOS*LUMI*BR);
    h_ST_rgwt73_1SFOS->Fill(ST_rwgt73_1SFOS, weight_rwgt73_1SFOS*LUMI*BR);
    h_ST_rgwt74_1SFOS->Fill(ST_rwgt74_1SFOS, weight_rwgt74_1SFOS*LUMI*BR);
    h_ST_rgwt75_1SFOS->Fill(ST_rwgt75_1SFOS, weight_rwgt75_1SFOS*LUMI*BR);
    h_ST_rgwt76_1SFOS->Fill(ST_rwgt76_1SFOS, weight_rwgt76_1SFOS*LUMI*BR);
    h_ST_rgwt77_1SFOS->Fill(ST_rwgt77_1SFOS, weight_rwgt77_1SFOS*LUMI*BR);
    h_ST_bkg_1SFOS->Fill(ST_bkg_1SFOS, weight_bkg_1SFOS*LUMI);

    h_ST_rgwt67_2SFOS->Fill(ST_rwgt67_2SFOS, weight_rwgt67_2SFOS*LUMI*BR);
    h_ST_rgwt68_2SFOS->Fill(ST_rwgt68_2SFOS, weight_rwgt68_2SFOS*LUMI*BR);
    h_ST_rgwt69_2SFOS->Fill(ST_rwgt69_2SFOS, weight_rwgt69_2SFOS*LUMI*BR);
    h_ST_rgwt70_2SFOS->Fill(ST_rwgt70_2SFOS, weight_rwgt70_2SFOS*LUMI*BR);
    h_ST_rgwt71_2SFOS->Fill(ST_rwgt71_2SFOS, weight_rwgt71_2SFOS*LUMI*BR);
    h_ST_rgwt72_2SFOS->Fill(ST_rwgt72_2SFOS, weight_rwgt72_2SFOS*LUMI*BR);
    h_ST_rgwt73_2SFOS->Fill(ST_rwgt73_2SFOS, weight_rwgt73_2SFOS*LUMI*BR);
    h_ST_rgwt74_2SFOS->Fill(ST_rwgt74_2SFOS, weight_rwgt74_2SFOS*LUMI*BR);
    h_ST_rgwt75_2SFOS->Fill(ST_rwgt75_2SFOS, weight_rwgt75_2SFOS*LUMI*BR);
    h_ST_rgwt76_2SFOS->Fill(ST_rwgt76_2SFOS, weight_rwgt76_2SFOS*LUMI*BR);
    h_ST_rgwt77_2SFOS->Fill(ST_rwgt77_2SFOS, weight_rwgt77_2SFOS*LUMI*BR);
    h_ST_bkg_2SFOS->Fill(ST_bkg_2SFOS, weight_bkg_2SFOS*LUMI); 

    for(int j=1; j<h_ST_rgwt67_0SFOS->GetNbinsX()+1; j++) 
    {
      h_ST_rgwt67_0SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt67_0SFOS->GetBinContent(j)-h_ST_rgwt72_0SFOS->GetBinContent(j)));
      h_ST_rgwt68_0SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt68_0SFOS->GetBinContent(j)-h_ST_rgwt72_0SFOS->GetBinContent(j)));
      h_ST_rgwt69_0SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt69_0SFOS->GetBinContent(j)-h_ST_rgwt72_0SFOS->GetBinContent(j)));
      h_ST_rgwt70_0SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt70_0SFOS->GetBinContent(j)-h_ST_rgwt72_0SFOS->GetBinContent(j)));
      h_ST_rgwt71_0SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt71_0SFOS->GetBinContent(j)-h_ST_rgwt72_0SFOS->GetBinContent(j)));
      h_ST_rgwt72_0SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt72_0SFOS->GetBinContent(j)-h_ST_rgwt72_0SFOS->GetBinContent(j))+0.000001);
      h_ST_rgwt73_0SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt73_0SFOS->GetBinContent(j)-h_ST_rgwt72_0SFOS->GetBinContent(j)));
      h_ST_rgwt74_0SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt74_0SFOS->GetBinContent(j)-h_ST_rgwt72_0SFOS->GetBinContent(j)));
      h_ST_rgwt75_0SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt75_0SFOS->GetBinContent(j)-h_ST_rgwt72_0SFOS->GetBinContent(j)));
      h_ST_rgwt76_0SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt76_0SFOS->GetBinContent(j)-h_ST_rgwt72_0SFOS->GetBinContent(j)));
      h_ST_rgwt77_0SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt77_0SFOS->GetBinContent(j)-h_ST_rgwt72_0SFOS->GetBinContent(j)));

      h_ST_rgwt67_1SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt67_1SFOS->GetBinContent(j)-h_ST_rgwt72_1SFOS->GetBinContent(j)));
      h_ST_rgwt68_1SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt68_1SFOS->GetBinContent(j)-h_ST_rgwt72_1SFOS->GetBinContent(j)));
      h_ST_rgwt69_1SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt69_1SFOS->GetBinContent(j)-h_ST_rgwt72_1SFOS->GetBinContent(j)));
      h_ST_rgwt70_1SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt70_1SFOS->GetBinContent(j)-h_ST_rgwt72_1SFOS->GetBinContent(j)));
      h_ST_rgwt71_1SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt71_1SFOS->GetBinContent(j)-h_ST_rgwt72_1SFOS->GetBinContent(j)));
      h_ST_rgwt72_1SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt72_1SFOS->GetBinContent(j)-h_ST_rgwt72_1SFOS->GetBinContent(j))+0.000001);
      h_ST_rgwt73_1SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt73_1SFOS->GetBinContent(j)-h_ST_rgwt72_1SFOS->GetBinContent(j)));
      h_ST_rgwt74_1SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt74_1SFOS->GetBinContent(j)-h_ST_rgwt72_1SFOS->GetBinContent(j)));
      h_ST_rgwt75_1SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt75_1SFOS->GetBinContent(j)-h_ST_rgwt72_1SFOS->GetBinContent(j)));
      h_ST_rgwt76_1SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt76_1SFOS->GetBinContent(j)-h_ST_rgwt72_1SFOS->GetBinContent(j)));
      h_ST_rgwt77_1SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt77_1SFOS->GetBinContent(j)-h_ST_rgwt72_1SFOS->GetBinContent(j)));

      h_ST_rgwt67_2SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt67_2SFOS->GetBinContent(j)-h_ST_rgwt72_2SFOS->GetBinContent(j)));
      h_ST_rgwt68_2SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt68_2SFOS->GetBinContent(j)-h_ST_rgwt72_2SFOS->GetBinContent(j)));
      h_ST_rgwt69_2SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt69_2SFOS->GetBinContent(j)-h_ST_rgwt72_2SFOS->GetBinContent(j)));
      h_ST_rgwt70_2SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt70_2SFOS->GetBinContent(j)-h_ST_rgwt72_2SFOS->GetBinContent(j)));
      h_ST_rgwt71_2SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt71_2SFOS->GetBinContent(j)-h_ST_rgwt72_2SFOS->GetBinContent(j)));
      h_ST_rgwt72_2SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt72_2SFOS->GetBinContent(j)-h_ST_rgwt72_2SFOS->GetBinContent(j))+0.000001);
      h_ST_rgwt73_2SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt73_2SFOS->GetBinContent(j)-h_ST_rgwt72_2SFOS->GetBinContent(j)));
      h_ST_rgwt74_2SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt74_2SFOS->GetBinContent(j)-h_ST_rgwt72_2SFOS->GetBinContent(j)));
      h_ST_rgwt75_2SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt75_2SFOS->GetBinContent(j)-h_ST_rgwt72_2SFOS->GetBinContent(j)));
      h_ST_rgwt76_2SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt76_2SFOS->GetBinContent(j)-h_ST_rgwt72_2SFOS->GetBinContent(j)));
      h_ST_rgwt77_2SFOS_MinusSM->SetBinContent(j, (h_ST_rgwt77_2SFOS->GetBinContent(j)-h_ST_rgwt72_2SFOS->GetBinContent(j)));

      h_ST_bkg_0SFOS_PlusSM->SetBinContent(j, (h_ST_bkg_0SFOS->GetBinContent(j)+h_ST_rgwt72_0SFOS->GetBinContent(j)));
      h_ST_bkg_1SFOS_PlusSM->SetBinContent(j, (h_ST_bkg_1SFOS->GetBinContent(j)+h_ST_rgwt72_1SFOS->GetBinContent(j)));
      h_ST_bkg_2SFOS_PlusSM->SetBinContent(j, (h_ST_bkg_2SFOS->GetBinContent(j)+h_ST_rgwt72_2SFOS->GetBinContent(j))); 
    }
  }

  std::string histfilename=(outfile+".root").c_str();
  TFile *tFile=new TFile(histfilename.c_str(), "RECREATE");
  h_ST_rgwt67_0SFOS->Write();
  h_ST_rgwt68_0SFOS->Write();
  h_ST_rgwt69_0SFOS->Write();
  h_ST_rgwt70_0SFOS->Write();
  h_ST_rgwt71_0SFOS->Write();
  h_ST_rgwt72_0SFOS->Write();
  h_ST_rgwt73_0SFOS->Write();
  h_ST_rgwt74_0SFOS->Write();
  h_ST_rgwt75_0SFOS->Write();
  h_ST_rgwt76_0SFOS->Write();
  h_ST_rgwt77_0SFOS->Write();
  h_ST_rgwt67_1SFOS->Write();
  h_ST_rgwt68_1SFOS->Write();
  h_ST_rgwt69_1SFOS->Write();
  h_ST_rgwt70_1SFOS->Write();
  h_ST_rgwt71_1SFOS->Write();
  h_ST_rgwt72_1SFOS->Write();
  h_ST_rgwt73_1SFOS->Write();
  h_ST_rgwt74_1SFOS->Write();
  h_ST_rgwt75_1SFOS->Write();
  h_ST_rgwt76_1SFOS->Write();
  h_ST_rgwt77_1SFOS->Write();
  h_ST_rgwt67_2SFOS->Write();
  h_ST_rgwt68_2SFOS->Write();
  h_ST_rgwt69_2SFOS->Write();
  h_ST_rgwt70_2SFOS->Write();
  h_ST_rgwt71_2SFOS->Write();
  h_ST_rgwt72_2SFOS->Write();
  h_ST_rgwt73_2SFOS->Write();
  h_ST_rgwt74_2SFOS->Write();
  h_ST_rgwt75_2SFOS->Write();
  h_ST_rgwt76_2SFOS->Write();
  h_ST_rgwt77_2SFOS->Write();
  h_ST_rgwt67_0SFOS_MinusSM->Write();
  h_ST_rgwt68_0SFOS_MinusSM->Write();
  h_ST_rgwt69_0SFOS_MinusSM->Write();
  h_ST_rgwt70_0SFOS_MinusSM->Write();
  h_ST_rgwt71_0SFOS_MinusSM->Write();
  h_ST_rgwt72_0SFOS_MinusSM->Write();
  h_ST_rgwt73_0SFOS_MinusSM->Write();
  h_ST_rgwt74_0SFOS_MinusSM->Write();
  h_ST_rgwt75_0SFOS_MinusSM->Write();
  h_ST_rgwt76_0SFOS_MinusSM->Write();
  h_ST_rgwt77_0SFOS_MinusSM->Write();
  h_ST_rgwt67_1SFOS_MinusSM->Write();
  h_ST_rgwt68_1SFOS_MinusSM->Write();
  h_ST_rgwt69_1SFOS_MinusSM->Write();
  h_ST_rgwt70_1SFOS_MinusSM->Write();
  h_ST_rgwt71_1SFOS_MinusSM->Write();
  h_ST_rgwt72_1SFOS_MinusSM->Write();
  h_ST_rgwt73_1SFOS_MinusSM->Write();
  h_ST_rgwt74_1SFOS_MinusSM->Write();
  h_ST_rgwt75_1SFOS_MinusSM->Write();
  h_ST_rgwt76_1SFOS_MinusSM->Write();
  h_ST_rgwt77_1SFOS_MinusSM->Write();
  h_ST_rgwt67_2SFOS_MinusSM->Write();
  h_ST_rgwt68_2SFOS_MinusSM->Write();
  h_ST_rgwt69_2SFOS_MinusSM->Write();
  h_ST_rgwt70_2SFOS_MinusSM->Write();
  h_ST_rgwt71_2SFOS_MinusSM->Write();
  h_ST_rgwt72_2SFOS_MinusSM->Write();
  h_ST_rgwt73_2SFOS_MinusSM->Write();
  h_ST_rgwt74_2SFOS_MinusSM->Write();
  h_ST_rgwt75_2SFOS_MinusSM->Write();
  h_ST_rgwt76_2SFOS_MinusSM->Write();
  h_ST_rgwt77_2SFOS_MinusSM->Write();
  h_ST_bkg_0SFOS->Write();
  h_ST_bkg_1SFOS->Write();
  h_ST_bkg_2SFOS->Write();
  h_ST_bkg_0SFOS_PlusSM->Write();
  h_ST_bkg_1SFOS_PlusSM->Write();
  h_ST_bkg_2SFOS_PlusSM->Write();
  tFile->Close(); 
  std::cout<<"Wrote output file "<<histfilename<<std::endl;
  return 0;
}
